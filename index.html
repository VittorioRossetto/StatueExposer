<!-- Licensed under a BSD license. See license.html for license -->
<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>ProgettoGrafica</title>
    <!--<link type="text/css" href="resources/webgl-tutorials.css" rel="stylesheet" />-->
    </head>
    <body>
        <style>
            body, html {
                margin: 0;
                padding: 0;
                overflow: hidden;
                width: 100%;
                height: 100%;
            }
            canvas {
                display: block;
                width: 100%;
                height: 100%;
            }
            #panel {
                position: absolute;
                top: 10px;
                left: 10px;
                background: rgba(255, 255, 255, 0.9); /* Slightly more opaque */
                padding: 15px; /* Increased padding */
                border-radius: 8px; /* Slightly more rounded corners */
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow */
                border: 1px solid rgba(0, 0, 0, 0.1); /* Light border */
                font-family: 'Arial', sans-serif; /* Modern font */
                font-size: 14px; /* Slightly larger font size */
                color: #333; /* Darker text color */
            }

            #resetViewButton, #togglePanelButton {
                margin-top: 10px;
                padding: 10px 20px;
                border: none;
                border-radius: 5px;
                background-color: #007BFF;
                color: white;
                font-size: 14px;
                cursor: pointer;
            }

            #resetViewButton:hover, #togglePanelButton:hover {
                background-color: #0056b3;
            }
            #togglePanelButton {
                position: absolute;
                top: 10px;
                right: 10px;
            }
        </style>
    <canvas id="canvas" width="600" height="600"></canvas>
    </body>
    <div id="panel">
        <label for="fov">Field of View:</label>
        <input type="range" id="fov" min="10" max="90" value="30"><br>
        <label for="cameraX">Camera X:</label>
        <input type="range" id="cameraX" min="-10" max="10" value="0"><br>
        <label for="cameraY">Camera Y:</label>
        <input type="range" id="cameraY" min="-10" max="10" value="-1"><br>
        <label for="cameraZ">Camera Z:</label>
        <input type="range" id="cameraZ" min="0" max="10" value="5"><br>
        <button id="resetViewButton">Reset View</button>
    </div>
    <button id="togglePanelButton">Option Panel</button>
    <!-- vertex shader -->
    <script id="3d-vertex-shader" type="x-shader/x-vertex">
    attribute vec4 a_position;
    attribute vec3 a_normal;
    attribute vec2 a_texcoord;

    uniform mat4 u_projection;
    uniform mat4 u_view;
    uniform mat4 u_world;
    uniform vec3 u_viewWorldPosition;

    varying vec3 v_normal;
    varying vec3 v_surfaceToView;
    varying vec2 v_texcoord;

    void main() {
        vec4 worldPosition = u_world * a_position;
        gl_Position = u_projection * u_view * worldPosition;
        v_surfaceToView = u_viewWorldPosition - worldPosition.xyz;
        v_normal = mat3(u_world) * a_normal;
        v_texcoord = a_texcoord;
    }
    </script>
    <!-- fragment shader -->
    <script id="3d-fragment-shader" type="x-shader/x-fragment">
    precision highp float;

    varying vec3 v_normal;
    varying vec3 v_surfaceToView;
    varying vec2 v_texcoord;

    uniform vec3 diffuse;
    uniform vec3 ambient;
    uniform vec3 emissive;
    uniform vec3 specular;
    uniform float shininess;
    uniform float opacity;
    uniform vec3 u_lightDirection;
    uniform vec3 u_ambientLight;
    uniform vec3 u_colorLight;
    uniform sampler2D diffuseMap;

    void main () {
        vec3 normal = normalize(v_normal);

        vec3 surfaceToViewDirection = normalize(v_surfaceToView);
        vec3 halfVector = normalize(u_lightDirection + surfaceToViewDirection);

        float fakeLight = dot(u_lightDirection, normal) * .5 + .5;
        float specularLight = clamp(dot(normal, halfVector), 0.0, 1.0);

        vec4 diffuseMapColor = texture2D(diffuseMap, v_texcoord);
        vec3 effectiveDiffuse = diffuse * diffuseMapColor.rgb * u_colorLight.rgb;
        float effectiveOpacity = opacity * diffuseMapColor.a;

        gl_FragColor = vec4(
            emissive +
            ambient * u_ambientLight +
            effectiveDiffuse * fakeLight +
            specular * pow(specularLight, shininess),
            effectiveOpacity);
    }
    </script>

    <script type="text/javascript" src="resources/mesh_utils.js"></script>
    <script type="text/javascript" src="resources/glm_utils.js"></script>
    <script type="text/javascript" src="resources/webgl-utils.js"></script>
    <script type="text/javascript" src="resources/m4.js"></script>
    <script type="text/javascript" src="resources/jquery-3.6.0.js"></script>
    <script type="text/javascript" src="load_mesh.js"></script>
    <script type="text/javascript" src="main.js"></script>

</html>



